{% extends "base.html" %}
{% load static %}
{% load bag_tools %}
{% block extra_corecss %}
<link rel="stylesheet" href="{% static 'checkout/css/checkout.css' %}">
{% endblock %}
{% block content %}
<div class="container px-4 px-lg-0">
    <div class="spinner-border" role="status">
        <span class="visually-hidden">Loading...</span>
    </div>
    <button id="submit-button" class="card-footer btn btn-primary btn-lg m-0">
        <span class="font-weight-bold">Complete Order</span>
        <span class="icon">
            <i class="fas fa-lock"></i>
        </span>
    </button>
</div>
{% block postloadjs %}
{{ block.super }}
<script src="https://js.stripe.com/v3/"></script>
<script>
    var stripe = Stripe('{{ stripe_public_key }}');

    $(document).ready(function () {
        $('#submit-button').on('click', function (event) {
            event.preventDefault();

            var sessionId = '{{ session_id }}';

            stripe.redirectToCheckout({
                sessionId: sessionId
            }).then(function (result) {
                if (result.error) {
                    console.error(result.error.message);
                }
            });
        });
    });
</script>
{% endblock %}
{% endblock content %}